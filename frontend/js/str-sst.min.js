const def=["Amelogenin","CSF1PO","D2S1338","D3S1358","D5S818","D7S820","D8S1179","D13S317","D16S539","D18S51","D19S433","D21S11","FGA","Penta_D","Penta_E","TH01","TPOX","vWA"],opt=["D10S1248","D1S1656","D2S441","D6S1043","D12S391","D22S1045","DXS101","DYS391","F13A01","F13B","FESFPS","LPL","Penta_C","SE33"];var all=["Amelogenin","CSF1PO","D1S1656","D2S1338","D2S441","D3S1358","D5S818","D6S1043","D7S820","D8S1179","D10S1248","D12S391","D13S317","D16S539","D18S51","D19S433","D21S11","D22S1045","DXS101","DYS391","F13A01","F13B","FESFPS","FGA","LPL","Penta_C","Penta_D","Penta_E","SE33","TH01","TPOX","vWA"];const html=$("html");var jsonInput,jsonQuery,jsonResponse,dialogImport,dialogExport;function resetAll(){resetMarkers(),document.getElementById("input-tanabe").checked=!0,document.getElementById("input-nonempty").checked=!0,document.getElementById("check-include-Amelogenin").checked=!1,document.getElementById("filter-score").value=60,document.getElementById("filter-size").value=200,document.getElementById("results").style.display="none",document.getElementById("warning").style.display="none",document.getElementById("import-name").value="Cellosaurus_STR_Results",document.getElementById("export-name").value="Cellosaurus_STR_Results",document.getElementById("import-extension").value="xlsx",document.getElementById("export-extension").value="xlsx",document.getElementById("input-file").value="",document.getElementById("import-help").innerHTML="",document.getElementById("samples").innerHTML="",document.getElementById("sample-label").innerHTML="",document.getElementById("sample-label").style.display="none",document.getElementById("warning").style.opacity="0",document.getElementById("results").style.opacity="0",$("#sib_header_small,#sib_footer").width("100%"),$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled"),switchIcon("import","xlsx"),switchIcon("export","xlsx")}function resetMarkers(){for(var e=0;e<def.length;e++)document.getElementById("input-"+def[e]).value="",document.getElementById("input-"+def[e]).style.color="#000000",document.getElementById("input-"+def[e]).style.borderColor="#ccc";for(e=0;e<opt.length;e++)document.getElementById("input-"+opt[e]).value="",document.getElementById("input-"+opt[e]).style.color="#000000",document.getElementById("input-"+opt[e]).style.borderColor="#ccc",document.getElementById("check-"+opt[e]).checked=!1,document.getElementById("input-"+opt[e]).disabled=!0,document.getElementById("input-"+opt[e]).value="",document.getElementById("label-"+opt[e]).style.color="#7e7e7e"}function parseURLVariables(){if(window.location.search.length>0)for(var e=window.location.search.substring(1).split("&"),t=0;t<e.length;t++)if(void 0!==e[t]&&0!==e[t].length&&e[t].includes("=")){var n=e[t].split("="),o=n[0].split("%20").join("_"),l=n[1].split("%20").join("").split("%22").join("").split("%27").join("");-1!==def.indexOf(o)?document.getElementById("input-"+o).value=l:-1!==opt.indexOf(o)?(document.getElementById("input-"+o).value=l,document.getElementById("input-"+o).disabled=!1,document.getElementById("check-"+o).checked=!0,document.getElementById("label-"+o).style.color="#107dac"):"name"===o&&(document.getElementById("description").value=l,document.getElementById("sample-label").innerHTML="Cellosaurus entry <b style='color:#ac3dad'>"+l+"</b> loaded",$("#sample-label").show("slide",400))}}function bindEvents(){for(var e=0;e<def.length;e++){var t=document.getElementById("input-"+def[e]);t.onkeypress=t.onpaste=0===e?restrictXYEvent:restrictSTREvent,t.onblur=blurEvent,t.oninput=inputEvent,validateElement(t)}for(e=0;e<opt.length;e++)(t=document.getElementById("input-"+opt[e])).onkeypress=t.onpaste=restrictSTREvent,t.onblur=blurEvent,t.oninput=inputEvent,validateElement(t);window.onscroll=scrollable}function restrictXYEvent(e){if(e.ctrlKey||" "===e.key||"Backspace"===e.key||"Delete"===e.key)return!0;var t="keypress"===e.type?String.fromCharCode(e.keyCode||e.which):(e.clipboardData||window.clipboardData).getData("Text");return!/[^\sxy,]/i.test(t)}function restrictSTREvent(e){if(e.ctrlKey||" "===e.key||"Backspace"===e.key||"Delete"===e.key)return!0;var t="keypress"===e.type?String.fromCharCode(e.keyCode||e.which):(e.clipboardData||window.clipboardData).getData("Text");return!/[^\s\d,.]/.test(t)}function inputEvent(){document.getElementById("sample-label").innerHTML=""}function blurEvent(e){validateElement(document.getElementById(e.target.id))}function validateElement(e){var t=e.value.split(" ").join(""),n="color:#ff0000;border-color:#ff0000",o="color:#000000;border-color:#ccc";0===t.length?e.style=o:/[,.]{2,}|\d{3,}|(\.\d{2,}|[,.]$|^[,.])/.test(t)?e.style=n:"input-Amelogenin"===e.id?/^[xyXY](,[xyXY])?$/.test(t)?e.style=o:e.style=n:/^[0-9,.]+$/.test(t)?e.style=o:e.style=n}function scrollable(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("scroller").style.display="block":document.getElementById("scroller").style.display="none"}function scrollUp(){document.body.scrollIntoView({behavior:"instant",block:"start",inline:"nearest"})}function switchIcon(e,t){switch(document.getElementById(e+"-xlsx").style.display="none",document.getElementById(e+"-csv").style.display="none",document.getElementById(e+"-json").style.display="none",document.getElementById(e+"-pdf").style.display="none",t){case"xlsx":document.getElementById(e+"-xlsx").style.display="block";break;case"csv":document.getElementById(e+"-csv").style.display="block";break;case"json":document.getElementById(e+"-json").style.display="block";break;case"pdf":document.getElementById(e+"-pdf").style.display="block"}}function jsonParameters(){var e={};return e.algorithm=$("input[name=score]:checked").val(),e.scoringMode=$("input[name=mode]:checked").val(),e.scoreFilter=document.getElementById("filter-score").value,e.maxResults=document.getElementById("filter-size").value,e.includeAmelogenin=document.getElementById("check-include-Amelogenin").checked,e}function search(){jsonQuery={};for(var e=0;e<def.length;e++){var t=document.getElementById("input-"+def[e]).value.split(" ").join("");""!==t&&(jsonQuery[def[e].split("_").join(" ")]=t)}for(e=0;e<opt.length;e++)""!==(t=document.getElementById("input-"+opt[e]).value.split(" ").join(""))&&(jsonQuery[opt[e].split("_").join(" ")]=t);if(0===Object.keys(jsonQuery).length)return document.getElementById("results").style.display="none",document.getElementById("warning").style.display="block",$("#warning").animate({opacity:1},400,"swing"),void document.getElementById("warning").scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"});jsonQuery.outputFormat="json",jQuery.extend(jsonQuery,jsonParameters()),html.addClass("waiting"),$.ajax({type:"POST",url:"/cellosaurus-str-search/api/query",data:JSON.stringify(jsonQuery),contentType:"application/json",dataType:"json",success:function(e,t,n){0!==e.results.length?(jsonResponse=e,table.build(e),$("#results").width()>$("#content").width()?$("#sib_header_small,#sib_footer").width($("#results").width()):$("#sib_header_small,#sib_footer").width("100%"),document.getElementById("results").style.display="table",$("#results").animate({opacity:1},1e3,"swing"),document.getElementById("warning").style.display="none",document.getElementById("caption").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})):(document.getElementById("results").style.display="none",document.getElementById("warning").style.display="block",$("#warning").animate({opacity:1},400,"swing"),document.getElementById("warning").scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}))},error:function(e,t,n){console.log(e),console.log(t),console.log(n),alert("Error: The server is not responding\nPlease contact an administrator")},complete:function(){html.removeClass("waiting")}})}$(document).ready(function(){resetAll(),parseURLVariables(),bindEvents()});var table={build:function(e){var t,n,o,l,s,a,r,i,d=[];for(Array.prototype.push.apply(d,all),l=0;l<opt.length;l++)!1===document.getElementById("check-"+opt[l]).checked&&d.splice(d.indexOf(opt[l]),1);var c="",u="<tr><th class='unselectable b0'><p class=\"sort-by\">Accession</p></th><th class='unselectable'><p class=\"sort-by\">Name</p></th><th class='unselectable'><p class=\"sort-by\">NÂº Markers</p></th></th><th class='unselectable'><p class=\"sort-by\">Score</p></th>";for(l=0;l<d.length;l++)"Amelogenin"===(t=d[l].split("_").join(" "))&&(t="Amel"),u+="<th class='unselectable'><p class=\"sort-by\">"+t+"</p></th>",c+="<td>"+document.getElementById("input-"+d[l]).value+"</td>";for(u+="</tr><tr><td class='b0'>NA</td><td>Query</td><td>NA</td><td>NA</td></td>"+c+"</tr>",l=0;l<e.results.length;l++)for(t in i={},e.results[l].profiles){for(n in e.results[l].profiles[t].markers){for(o in a=[],e.results[l].profiles[t].markers[n].alleles)!1===(r=e.results[l].profiles[t].markers[n].alleles[o]).matched?a.push("<span style='color:red'>"+r.value+"</span>"):a.push(r.value);var m=e.results[l].profiles[t].markers[n].name.split(" ").join("_");d.indexOf(m)>-1&&(e.results[l].profiles[t].markers[n].conflicted?i[m]='<a class="as" title="'+table._formatSources(e.results[l].profiles[t].markers[n].sources)+'">'+a.join(",")+"</a>":i[m]=a.join(","))}var p,y;for(u+="<tr>",p="1"===$("input[name=score]:checked").val()?e.results[l].profiles[t].score>=90?"b1":e.results[l].profiles[t].score<80?"b2":"b3":e.results[l].profiles[t].score>=80?"b1":e.results[l].profiles[t].score<60?"b2":"b3",y=0==t&&2===e.results[l].profiles.length?" <span style='color:#373434'><i>Best</i></span>":1==t?" <span style='color:#373434'><i>Worst</i></span>":"",e.results[l].problematic?u+="<td class='"+p+"'><a title=\""+table._formatDescription(e.results[l].problem)+"\" style='color:red' href=\"https://web.expasy.org/cellosaurus/"+e.results[l].accession+'" target="_blank">'+e.results[l].accession+"</a>"+y+"</td>":u+="<td class='"+p+"'><a href=\"https://web.expasy.org/cellosaurus/"+e.results[l].accession+'" target="_blank">'+e.results[l].accession+"</a>"+y+"</td>",u+="<td>"+e.results[l].name+"</td>",document.getElementById("check-include-Amelogenin").checked&&e.results[l].profiles[t].markerNumber<9||!document.getElementById("check-include-Amelogenin").checked&&e.results[l].profiles[t].markerNumber<8?u+="<td><span style='color:red' title='A minimum of eight STR markers (excluding Amelogenin) is recommended'>"+e.results[l].profiles[t].markerNumber+"</span></td>":u+="<td>"+e.results[l].profiles[t].markerNumber+"</td>",u+="<td>"+e.results[l].profiles[t].score.toFixed(2)+"%</td>",s=0;s<d.length;s++)void 0===(r=i[d[s]])&&(r=""),u+="<td>"+r+"</td>";u+="</tr>"}var g=$("#table-results");g.empty(),g.append(u),table._makeSortable()},_formatDescription:function(e){var t="<b>Problematic cell line:</b><br><span style='color:red;'>";return t+=e.replace(".","</span>.").replace(/(PubMed=)(\d+)/g,"$1<a class='ab' href='https://www.ncbi.nlm.nih.gov/pubmed/$2' target='_blank'>$2</a>").replace(/(DOI=)([\w/.]+)/g,"$1<a class='ab' href='https://www.doi.org/$2' target='_blank'>$2</a>")},_formatSources:function(e){var t="<b>Source";e.length>1&&(t+="s"),t+=":</b><br>";for(var n=0;n<e.length;n++)if(e[n].startsWith("PubMed")){var o=e[n].indexOf("_"),l=-1===o?e[n].length:o;t+=e[n].substring(0,7),t+="<a class='ab' href='https://www.ncbi.nlm.nih.gov/pubmed/",t+=e[n].substring(7,l),t+="' target='_blank'>",t+=e[n].substring(7,l),t+="</a>",-1!==o&&(t+=e[n].substring(o)),t+="<br>"}else e[n].startsWith("DOI")?(t+=e[n].substring(0,4),t+="<a class='ab' href='https://www.doi.org/",t+=e[n].substring(4),t+="' target='_blank'>",t+=e[n].substring(4),t+="</a><br>"):(t+=e[n],t+="<br>");return t},_makeSortable:function(){const e=(e,t)=>e.children[t].innerText||e.children[t].textContent;document.querySelectorAll("th").forEach(t=>t.addEventListener("click",()=>{for(var n=document.querySelectorAll("th"),o=0;o<n.length;o++)n[o].getElementsByClassName("sort-by")[0].className="sort-by";this.asc?t.getElementsByClassName("sort-by")[0].className="sort-by asc":t.getElementsByClassName("sort-by")[0].className="sort-by des";const l=t.closest("table");Array.from(l.querySelectorAll("tr:nth-child(n+3)")).sort(((t,n)=>(o,l)=>((e,t)=>""===e||""===t||isNaN(e)||isNaN(t)?function(e,t){if(e.endsWith("%")){for(;e.length<7;)e="0"+e;for(;t.length<7;)t="0"+t}return e.toString().localeCompare(t)}(e,t):e-t)(e(n?o:l,t),e(n?l:o,t)))(Array.from(t.parentNode.children).indexOf(t),this.asc=!this.asc)).forEach(e=>l.appendChild(e))}))}};function example(){resetMarkers(),document.getElementById("input-Amelogenin").value="X",document.getElementById("input-CSF1PO").value="11,12",document.getElementById("input-D2S1338").value="19,23",document.getElementById("input-D3S1358").value="15,17",document.getElementById("input-D5S818").value="11,12",document.getElementById("input-D7S820").value="10",document.getElementById("input-D8S1179").value="10",document.getElementById("input-D13S317").value="11,12",document.getElementById("input-D16S539").value="11,12",document.getElementById("input-D18S51").value="13",document.getElementById("input-D19S433").value="14",document.getElementById("input-D21S11").value="29,30",document.getElementById("input-FGA").value="20,22",document.getElementById("input-Penta_D").value="11,13",document.getElementById("input-Penta_E").value="14,16",document.getElementById("input-TH01").value="6,9",document.getElementById("input-TPOX").value="8,9",document.getElementById("input-vWA").value="17,19",document.getElementById("description").value="HT-29",document.getElementById("sample-label").innerHTML="Example <b style='color:#ac3dad'>HT-29</b> loaded",$("#sample-label").show("slide",400)}function check(e){document.getElementById("input-"+e).disabled?(document.getElementById("input-"+e).disabled=!1,document.getElementById("label-"+e).style.color="#107dac"):(document.getElementById("input-"+e).disabled=!0,document.getElementById("input-"+e).value="",document.getElementById("label-"+e).style.color="#7e7e7e")}var importFile={read:function(e){if(void 0!==e[0])switch(e[0].name.split(".").pop()){case void 0:break;case"csv":case"tsv":case"txt":importFile._csv(e[0]);break;case"xls":importFile._xls(e[0]);break;case"xlsx":importFile._xlsx(e[0])}},load:function(e){for(var t=0;t<jsonInput.length;t++)if(jsonInput[t].description===e){for(var n in resetMarkers(),document.getElementById("description").value=e,jsonInput[t])if(jsonInput[t].hasOwnProperty(n)){var o=importFile._format(n);if(def.includes(o)){var l=document.getElementById("input-"+o);l.value=jsonInput[t][n].split(" ").join(""),validateElement(l)}opt.includes(o)&&(document.getElementById("check-"+opt[t]).checked=!0,document.getElementById("label-"+t).style.color="#107dac",(l=document.getElementById("input-"+t)).disabled=!1,l.value=jsonInput[t][n].split(" ").join(""),validateElement(l))}document.getElementById("sample-label").innerHTML="Sample <b style='color:#ac3dad'>"+e+"</b> loaded",$("#sample-label").show("slide",400),dialogImport.dialog("close");break}},reload:function(e){for(var t=0;t<e.length;t++)e[t]=$.extend(e[t],jsonParameters()),e[t].outputFormat=$("#import-extension").val();return e},_callback:function(e){if(0===e.length)return document.getElementById("samples").innerHTML="<p style='color:red;'><b>Error:</b><br>The input file is empty.</p>",jsonInput={},void $("#batch").button().attr("disabled",!0).addClass("ui-state-disabled");e[0].Marker?jsonInput=importFile._genemapper(e):(jsonInput=e,importFile._rename(jsonInput));var t=importFile._validate(jsonInput);if(t>0)if(1===jsonInput.length)importFile.load(jsonInput[0].description);else{document.getElementById("import-help").innerHTML="<b>"+jsonInput.length+" samples detected:</b>";for(var n="<i>Click on a sample to load its values in the form or use<br>the <b>Batch Query</b> option to search them all</i><br><br>",o=0;o<jsonInput.length;o++)n+="<a class='sample' onclick='importFile.load(this.innerText)'>"+jsonInput[o].description+"</a><br>";document.getElementById("samples").innerHTML=n,$("#batch").button().attr("disabled",!1).removeClass("ui-state-disabled")}else-2===t?(document.getElementById("import-help").innerHTML="<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML='<span style=\'color:red;\'>No sample could be detected in the input file. Please check that your file contains a "Name", "Sample" or "Sample Name" column.</span>',jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled")):-1===t?(document.getElementById("import-help").innerHTML="<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML="<span style='color:red;'>Not all samples are named in the input file. Please name all your samples.</span>",jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled")):0===t&&(document.getElementById("import-help").innerHTML="<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML="<span style='color:red;'>No compatible marker was detected in the input file.</span>",jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled"))},_genemapper:function(e){for(var t=[],n={},o=e[0]["Sample Name"],l=0;l<e.length;l++){e[l]["Sample Name"]!==o&&(n.description=o,t.push(n),n={},o=e[l]["Sample Name"]);for(var s=[],a=1;e[l]["Allele "+a];)""!==e[l]["Allele "+a]&&s.push(e[l]["Allele "+a]),a++;n[e[l].Marker]=s.join(",")}return n.description=o,t.push(n),t},_format:function(e){var t=e.trim().toUpperCase().replace(" ","_");switch(t){case"AM":case"AMEL":case"AMELOGENIN":return"Amelogenin";case"THO1":return"TH01";case"CSF1P0":return"CSF1PO";case"VWA":return"vWA";case"PENTA_C":case"PENTA_D":case"PENTA_E":return"Penta_"+t[t.length-1];default:return t}},_rename:function(e){for(var t=[],n=0;n<e.length;n++)void 0!==e[n].SampleReferenceNbr?(e[n].description=importFile._renameCheck(t,e[n].SampleReferenceNbr),delete e[n].SampleReferenceNbr):void 0!==e[n].Sample?(e[n].description=importFile._renameCheck(t,e[n].Name),delete e[n].Sample):void 0!==e[n]["Sample Name"]?(e[n].description=importFile._renameCheck(t,e[n]["Sample Name"]),delete e[n]["Sample Name"]):void 0!==e[n].Name&&(e[n].description=importFile._renameCheck(t,e[n].Name),delete e[n].Name)},_renameCheck:function(e,t){if(e.includes(t)){for(var n=1;e.includes(t+"("+n+")");)n++;return e.push(t+"("+n+")"),t+"("+n+")"}return e.push(t),t},_validate:function(e){if(e.some(e=>!e.hasOwnProperty("description")))return-2;if(e.some(e=>0===e.description.length))return-1;for(var t=0,n=0;n<e.length;n++)for(var o in e[n])e[n].hasOwnProperty(o)&&(def.includes(o)||opt.includes(o))&&t++;return t},_csv:function(e){Papa.parse(e,{header:!0,skipEmptyLines:!0,complete:function(e){importFile._callback(e.data)}})},_xls:function(e){var t=new FileReader;t.onload=(e=>{const t=e.target.result,n=XLS.read(t,{type:"binary"}),o=n.SheetNames[0],l=n.Sheets[o],s=XLS.utils.sheet_to_json(l,{raw:!1,defval:""});importFile._callback(s)}),t.readAsBinaryString(e)},_xlsx:function(e){var t=new FileReader;t.onload=(e=>{const t=e.target.result,n=XLSX.read(t,{type:"binary"}),o=n.SheetNames[0],l=n.Sheets[o],s=XLSX.utils.sheet_to_json(l,{raw:!1,defval:""});importFile._callback(s)}),t.readAsBinaryString(e)},openDialog:function(){dialogImport.dialog("open")}},exportTable={toXlsx:function(e){$.ajax({type:"POST",url:"/cellosaurus-str-search/api/conversion",data:JSON.stringify(jsonResponse),contentType:"application/json",dataType:"text",mimeType:"text/plain; charset=x-user-defined",success:function(t,n,o){for(var l=e+".xlsx",s="",a=0;a<t.length;a++)s+=String.fromCharCode(255&t.charCodeAt(a));var r=new Uint8Array(s.length);for(a=0;a<s.length;a++)r[a]=s.charCodeAt(a);var i=o.getResponseHeader("Content-Type"),d=new Blob([r],{type:i}),c=window.URL||window.webkitURL,u=c.createObjectURL(d);if(l){var m=document.createElement("a");void 0===m.download?window.location=u:(m.href=u,m.download=l,document.body.appendChild(m),m.click())}else window.location=u;setTimeout(function(){c.revokeObjectURL(u)},100)},error:function(e,t,n){console.log(e),console.log(t),console.log(n),alert("Error: The server is not responding\nPlease contact an administrator")}})},toCsv:function(e){var t=this._tableToCSV(document.getElementById("table-results")),n=new Blob([t],{type:"text/csv"});navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(n,e+".csv"):this._downloadAnchor(URL.createObjectURL(n),e+".csv")},toJson:function(e){var t=new Blob([JSON.stringify(jsonResponse,void 0,2)],{type:"text/plain"});navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(t,e+".json"):this._downloadAnchor(URL.createObjectURL(t),e+".json")},_downloadAnchor:function(e,t){var n=document.createElement("a");n.style="display:none !important",n.id="downloadanchor",document.body.appendChild(n),"download"in n&&(n.download=t),n.href=e,n.click(),n.remove()},_tableToCSV:function(e){var t=[],n=[],o=',"#';o+="Description: '",o+=jsonResponse.description,o+="';Data set: 'Cellosaurus release ",o+=jsonResponse.cellosaurusRelease,o+="';Run on: '",o+=jsonResponse.runOn,o+="';Tool version: '",o+=jsonResponse.toolVersion,o+="';Algorithm: '",o+=jsonResponse.parameters.algorithm,o+="';Scoring mode: '",o+=jsonResponse.parameters.scoringMode,o+="';Score filter: '",o+=jsonResponse.parameters.scoreFilter,o+="';Max results: '",o+=jsonResponse.parameters.maxResults,o+="';Include Amelogenin: '",o+=jsonResponse.parameters.includeAmelogenin,o+="'\"";for(var l=0;l<e.rows.length;l++){for(var s=0;s<e.rows[0].cells.length;s++){var a='"';a+=e.rows[l].cells[s].textContent,0===s&&e.rows[l].cells[s].innerHTML.startsWith('<a title="Problematic')&&(a+=" (Problematic cell line)"),a+='"',n.push(a)}0===l?t.push(n.join(",")+o):t.push(n.join(",")),n=[]}return t.join("\r\n")},openDialog:function(){dialogExport.dialog("open")}};$(function(){(dialogImport=$("#dialog-import").dialog({autoOpen:!1,height:575,width:500,modal:!1,resizable:!1,closeText:null,hide:{effect:"fold",duration:300},show:{effect:"fold",duration:300},buttons:[{text:"Batch Query",disabled:!0,id:"batch",click:function(){html.addClass("waiting"),$("#import-progressbar").addClass("animate"),$.ajax({type:"POST",url:"/cellosaurus-str-search/api/batch",data:JSON.stringify(importFile.reload(jsonInput)),contentType:"application/json",dataType:"text",mimeType:"text/plain; charset=x-user-defined",success:function(e,t,n){for(var o="csv"===$("#import-extension").val()?"zip":$("#import-extension").val(),l=$("#import-name").val()+"."+o,s="",a=0;a<e.length;a++)s+=String.fromCharCode(255&e.charCodeAt(a));var r=new Uint8Array(s.length);for(a=0;a<s.length;a++)r[a]=s.charCodeAt(a);var i=n.getResponseHeader("Content-Type"),d=new Blob([r],{type:i}),c=window.URL||window.webkitURL,u=c.createObjectURL(d);if(l){var m=document.createElement("a");void 0===m.download?window.location=u:(m.href=u,m.download=l,document.body.appendChild(m),m.click())}else window.location=u;setTimeout(function(){c.revokeObjectURL(u)},100)},error:function(e,t,n){console.log(e),console.log(t),console.log(n),alert("Error: The server is not responding\nPlease contact an administrator")},complete:function(){dialogImport.dialog("close"),html.removeClass("waiting"),$("#import-progressbar").removeClass("animate")}})}},{text:"Close",click:function(){dialogImport.dialog("close")}}]})).find("form").on("submit",function(e){e.preventDefault()}),(dialogExport=$("#dialog-export").dialog({autoOpen:!1,height:350,width:450,modal:!0,resizable:!1,closeText:null,hide:{effect:"fold",duration:300},show:{effect:"fold",duration:300},buttons:{Save:function(){switch(html.addClass("waiting"),$("#export-progressbar").addClass("animate"),jsonResponse.description=$("#description").val(),document.getElementById("export-extension").value){case"xlsx":exportTable.toXlsx($("#export-name").val());break;case"csv":exportTable.toCsv($("#export-name").val());break;case"json":exportTable.toJson($("#export-name").val());break;case"pdf":exportTable.toPdf($("#export-name").val())}dialogExport.dialog("close"),html.removeClass("waiting"),$("#export-progressbar").removeClass("animate")},Close:function(){dialogExport.dialog("close")}},open:function(){$("#content").addClass("blur")},close:function(){$("#content").removeClass("blur")}})).find("form").on("submit",function(e){e.preventDefault()}),$(document).tooltip({content:function(){return $(this).prop("title")},position:{my:"left center",at:"right+15 center"},show:null,close:function(e,t){t.tooltip.hover(function(){$(this).stop(!0).fadeTo(400,1)},function(){$(this).fadeOut("400",function(){$(this).remove()})})}})});