var def="Amelogenin CSF1PO D2S1338 D3S1358 D5S818 D7S820 D8S1179 D13S317 D16S539 D18S51 D19S433 D21S11 FGA Penta_D Penta_E TH01 TPOX vWA".split(" "),opt="D10S1248 D1S1656 D2S441 D6S1043 D12S391 D22S1045 DXS101 DYS391 F13A01 F13B FESFPS LPL Penta_C SE33".split(" "),all="Amelogenin CSF1PO D1S1656 D2S1338 D2S441 D3S1358 D5S818 D6S1043 D7S820 D8S1179 D10S1248 D12S391 D13S317 D16S539 D18S51 D19S433 D21S11 D22S1045 DXS101 DYS391 F13A01 F13B FESFPS FGA LPL Penta_C Penta_D Penta_E SE33 TH01 TPOX vWA".split(" "),
    html=$("html"),jsonInput,jsonQuery,jsonResponse,dialogImport,dialogExport;$(document).ready(function(){resetAll();parseURLVariables();bindEvents()});
function resetAll(){resetMarkers();document.getElementById("input-tanabe").checked=!0;document.getElementById("input-nonempty").checked=!0;document.getElementById("check-include-Amelogenin").checked=!1;document.getElementById("filter-score").value=60;document.getElementById("filter-size").value=200;document.getElementById("results").style.display="none";document.getElementById("warning").style.display="none";document.getElementById("import-name").value="Cellosaurus_STR_Results";document.getElementById("export-name").value=
    "Cellosaurus_STR_Results";document.getElementById("import-extension").value="xlsx";document.getElementById("export-extension").value="xlsx";document.getElementById("input-file").value="";document.getElementById("import-help").innerHTML="";document.getElementById("samples").innerHTML="";document.getElementById("sample-label").innerHTML="";document.getElementById("sample-label").style.display="none";document.getElementById("warning").style.opacity="0";document.getElementById("results").style.opacity=
    "0";$("#sib_header_small,#sib_footer").width("100%");$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled");switchIcon("import","xlsx");switchIcon("export","xlsx")}
function resetMarkers(){for(var a=0;a<def.length;a++)document.getElementById("input-"+def[a]).value="",document.getElementById("input-"+def[a]).style.color="#000000",document.getElementById("input-"+def[a]).style.borderColor="#ccc";for(a=0;a<opt.length;a++)document.getElementById("input-"+opt[a]).value="",document.getElementById("input-"+opt[a]).style.color="#000000",document.getElementById("input-"+opt[a]).style.borderColor="#ccc",document.getElementById("check-"+opt[a]).checked=!1,document.getElementById("input-"+
    opt[a]).disabled=!0,document.getElementById("input-"+opt[a]).value="",document.getElementById("label-"+opt[a]).style.color="#7e7e7e"}
function parseURLVariables(){if(0<window.location.search.length)for(var a=window.location.search.substring(1).split("&"),b=0;b<a.length;b++)if(void 0!==a[b]&&0!==a[b].length&&a[b].includes("=")){var d=a[b].split("="),c=d[0].split("%20").join("_");d=d[1].split("%20").join("").split("%22").join("").split("%27").join("");-1!==def.indexOf(c)?document.getElementById("input-"+c).value=d:-1!==opt.indexOf(c)?(document.getElementById("input-"+c).value=d,document.getElementById("input-"+c).disabled=!1,document.getElementById("check-"+
    c).checked=!0,document.getElementById("label-"+c).style.color="#107dac"):"name"===c&&(document.getElementById("description").value=d,document.getElementById("sample-label").innerHTML="Cellosaurus entry <b style='color:#ac3dad'>"+d+"</b> loaded",$("#sample-label").show("slide",400))}}
function bindEvents(){for(var a=0;a<def.length;a++){var b=document.getElementById("input-"+def[a]);b.onkeypress=0===a?b.onpaste=restrictXYEvent:b.onpaste=restrictSTREvent;b.onblur=blurEvent;b.oninput=inputEvent;validateElement(b)}for(a=0;a<opt.length;a++)b=document.getElementById("input-"+opt[a]),b.onkeypress=b.onpaste=restrictSTREvent,b.onblur=blurEvent,b.oninput=inputEvent,validateElement(b);window.onscroll=scrollable}
function restrictXYEvent(a){if(a.ctrlKey||" "===a.key||"Backspace"===a.key||"Delete"===a.key)return!0;a="keypress"===a.type?String.fromCharCode(a.keyCode||a.which):(a.clipboardData||window.clipboardData).getData("Text");return!/[^\sxy,]/i.test(a)}function restrictSTREvent(a){if(a.ctrlKey||" "===a.key||"Backspace"===a.key||"Delete"===a.key)return!0;a="keypress"===a.type?String.fromCharCode(a.keyCode||a.which):(a.clipboardData||window.clipboardData).getData("Text");return!/[^\s\d,.]/.test(a)}
function inputEvent(){document.getElementById("sample-label").innerHTML=""}function blurEvent(a){validateElement(document.getElementById(a.target.id))}
function validateElement(a){var b=a.value.split(" ").join("");0===b.length?a.style="color:#000000;border-color:#ccc":/[,.]{2,}|\d{3,}|(\.\d{2,}|[,.]$|^[,.])/.test(b)?a.style="color:#ff0000;border-color:#ff0000":"input-Amelogenin"===a.id?/^[XY,]+$/.test(b)?a.style="color:#000000;border-color:#ccc":a.style="color:#ff0000;border-color:#ff0000":/^[0-9,.]+$/.test(b)?a.style="color:#000000;border-color:#ccc":a.style="color:#ff0000;border-color:#ff0000"}
function scrollable(){20<document.body.scrollTop||20<document.documentElement.scrollTop?document.getElementById("scroller").style.display="block":document.getElementById("scroller").style.display="none"}function scrollUp(){document.body.scrollIntoView({behavior:"instant",block:"start",inline:"nearest"})}
function switchIcon(a,b){document.getElementById(a+"-xlsx").style.display="none";document.getElementById(a+"-csv").style.display="none";document.getElementById(a+"-json").style.display="none";document.getElementById(a+"-pdf").style.display="none";switch(b){case "xlsx":document.getElementById(a+"-xlsx").style.display="block";break;case "csv":document.getElementById(a+"-csv").style.display="block";break;case "json":document.getElementById(a+"-json").style.display="block";break;case "pdf":document.getElementById(a+
    "-pdf").style.display="block"}}function jsonParameters(){var a={};a.algorithm=$("input[name=score]:checked").val();a.scoringMode=$("input[name=mode]:checked").val();a.scoreFilter=document.getElementById("filter-score").value;a.maxResults=document.getElementById("filter-size").value;a.includeAmelogenin=document.getElementById("check-include-Amelogenin").checked;return a}
function search(){jsonQuery={};for(var a=0;a<def.length;a++){var b=document.getElementById("input-"+def[a]).value.split(" ").join("");""!==b&&(jsonQuery[def[a].split("_").join(" ")]=b)}for(a=0;a<opt.length;a++)b=document.getElementById("input-"+opt[a]).value.split(" ").join(""),""!==b&&(jsonQuery[opt[a].split("_").join(" ")]=b);0===Object.keys(jsonQuery).length?(document.getElementById("results").style.display="none",document.getElementById("warning").style.display="block",$("#warning").animate({opacity:1},
    400,"swing"),document.getElementById("warning").scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})):(jsonQuery.outputFormat="json",jQuery.extend(jsonQuery,jsonParameters()),html.addClass("waiting"),$.ajax({type:"POST",url:"/cellosaurus-str-search/api/query",data:JSON.stringify(jsonQuery),contentType:"application/json",dataType:"json",success:function(a,b,e){0!==a.results.length?(jsonResponse=a,table.build(a),$("#results").width()>$("#content").width()?$("#sib_header_small,#sib_footer").width($("#results").width()):
        $("#sib_header_small,#sib_footer").width("100%"),document.getElementById("results").style.display="table",$("#results").animate({opacity:1},1E3,"swing"),document.getElementById("warning").style.display="none",document.getElementById("caption").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})):(document.getElementById("results").style.display="none",document.getElementById("warning").style.display="block",$("#warning").animate({opacity:1},400,"swing"),document.getElementById("warning").scrollIntoView({behavior:"smooth",
        block:"end",inline:"nearest"}))},error:function(a,b,e){console.log(a);console.log(b);console.log(e);alert("Error: The server is not responding\nPlease contact an administrator")},complete:function(){html.removeClass("waiting")}}))}
var table={build:function(a){var b,d,c,e=[];Array.prototype.push.apply(e,all);for(c=0;c<opt.length;c++)!1===document.getElementById("check-"+opt[c]).checked&&e.splice(e.indexOf(opt[c]),1);var h="";var f="<tr><th class='unselectable b0'><p class=\"sort-by\">Accession</p></th><th class='unselectable'><p class=\"sort-by\">Name</p></th><th class='unselectable'><p class=\"sort-by\">N\u00ba Markers</p></th></th><th class='unselectable'><p class=\"sort-by\">Score</p></th>";for(c=0;c<e.length;c++){var g=
        e[c].split("_").join(" ");"Amelogenin"===g&&(g="Amel");f+="<th class='unselectable'><p class=\"sort-by\">"+g+"</p></th>";h+="<td>"+document.getElementById("input-"+e[c]).value+"</td>"}f+="</tr><tr><td class='b0'>NA</td><td>Query</td><td>NA</td><td>NA</td></td>"+h+"</tr>";for(c=0;c<a.results.length;c++)for(g in h={},a.results[c].profiles){for(b in a.results[c].profiles[g].markers){var l=[];for(d in a.results[c].profiles[g].markers[b].alleles){var k=a.results[c].profiles[g].markers[b].alleles[d];!1===
    k.matched?l.push("<span style='color:red'>"+k.value+"</span>"):l.push(k.value)}k=a.results[c].profiles[g].markers[b].name.split(" ").join("_");-1<e.indexOf(k)&&(h[k]=a.results[c].profiles[g].markers[b].conflicted?'<a class="as" title="'+table._formatSources(a.results[c].profiles[g].markers[b].sources)+'">'+l.join(",")+"</a>":l.join(","))}f+="<tr>";l="1"===$("input[name=score]:checked").val()?90<=a.results[c].profiles[g].score?"b1":80>a.results[c].profiles[g].score?"b2":"b3":80<=a.results[c].profiles[g].score?
        "b1":60>a.results[c].profiles[g].score?"b2":"b3";k=0==g&&2===a.results[c].profiles.length?" <span style='color:#373434'><i>Best</i></span>":1==g?" <span style='color:#373434'><i>Worst</i></span>":"";f=a.results[c].problematic?f+("<td class='"+l+"'><a title=\""+table._formatDescription(a.results[c].problem)+"\" style='color:red' href=\"https://web.expasy.org/cellosaurus/"+a.results[c].accession+'" target="_blank">'+a.results[c].accession+"</a>"+k+"</td>"):f+("<td class='"+l+"'><a href=\"https://web.expasy.org/cellosaurus/"+
        a.results[c].accession+'" target="_blank">'+a.results[c].accession+"</a>"+k+"</td>");f+="<td>"+a.results[c].name+"</td>";f=document.getElementById("check-include-Amelogenin").checked&&9>a.results[c].profiles[g].markerNumber||!document.getElementById("check-include-Amelogenin").checked&&8>a.results[c].profiles[g].markerNumber?f+("<td><span style='color:red' title='A minimum of eight STR markers (excluding Amelogenin) is recommended'>"+a.results[c].profiles[g].markerNumber+"</span></td>"):f+("<td>"+
        a.results[c].profiles[g].markerNumber+"</td>");f+="<td>"+a.results[c].profiles[g].score.toFixed(2)+"%</td>";for(l=0;l<e.length;l++)k=h[e[l]],void 0===k&&(k=""),f+="<td>"+k+"</td>";f+="</tr>"}a=$("#table-results");a.empty();a.append(f);table._makeSortable()},_formatDescription:function(a){return"<b>Problematic cell line:</b><br><span style='color:red;'>"+a.replace(".","</span>.").replace(/(PubMed=)(\d+)/g,"$1<a class='ab' href='https://www.ncbi.nlm.nih.gov/pubmed/$2' target='_blank'>$2</a>").replace(/(DOI=)([\w/.]+)/g,
        "$1<a class='ab' href='https://www.doi.org/$2' target='_blank'>$2</a>")},_formatSources:function(a){var b="<b>Source";1<a.length&&(b+="s");b+=":</b><br>";for(var d=0;d<a.length;d++)a[d].startsWith("PubMed")?(b+=a[d].substring(0,7),b+="<a class='ab' href='https://www.ncbi.nlm.nih.gov/pubmed/",b+=a[d].substring(7),b+="' target='_blank'>",b+=a[d].substring(7),b+="</a><br>"):a[d].startsWith("DOI")?(b+=a[d].substring(0,4),b+="<a class='ab' href='https://www.doi.org/",b+=a[d].substring(4),b+="' target='_blank'>",
        b+=a[d].substring(4),b+="</a><br>"):(b+=a[d],b+="<br>");return b},_makeSortable:function(){var a=this,b=function(a,b){return a.children[b].innerText||a.children[b].textContent},d=function(a,d){return function(c,e){var g=b(d?c:e,a),f=b(d?e:c,a);if(""===g||""===f||isNaN(g)||isNaN(f)){if(g.endsWith("%")){for(;7>g.length;)g="0"+g;for(;7>f.length;)f="0"+f}f=g.toString().localeCompare(f)}else f=g-f;return f}};document.querySelectorAll("th").forEach(function(b){return b.addEventListener("click",function(){for(var c=
        document.querySelectorAll("th"),h=0;h<c.length;h++)c[h].getElementsByClassName("sort-by")[0].className="sort-by";a.asc?b.getElementsByClassName("sort-by")[0].className="sort-by asc":b.getElementsByClassName("sort-by")[0].className="sort-by des";var f=b.closest("table");Array.from(f.querySelectorAll("tr:nth-child(n+3)")).sort(d(Array.from(b.parentNode.children).indexOf(b),a.asc=!a.asc)).forEach(function(a){return f.appendChild(a)})})})}};
function example(){resetMarkers();document.getElementById("input-Amelogenin").value="X";document.getElementById("input-CSF1PO").value="11,12";document.getElementById("input-D2S1338").value="19,23";document.getElementById("input-D3S1358").value="15,17";document.getElementById("input-D5S818").value="11,12";document.getElementById("input-D7S820").value="10";document.getElementById("input-D8S1179").value="10";document.getElementById("input-D13S317").value="11,12";document.getElementById("input-D16S539").value=
    "11,12";document.getElementById("input-D18S51").value="13";document.getElementById("input-D19S433").value="14";document.getElementById("input-D21S11").value="29,30";document.getElementById("input-FGA").value="20,22";document.getElementById("input-Penta_D").value="11,13";document.getElementById("input-Penta_E").value="14,16";document.getElementById("input-TH01").value="6,9";document.getElementById("input-TPOX").value="8,9";document.getElementById("input-vWA").value="17,19";document.getElementById("description").value=
    "HT-29";document.getElementById("sample-label").innerHTML="Example <b style='color:#ac3dad'>HT-29</b> loaded";$("#sample-label").show("slide",400)}function check(a){document.getElementById("input-"+a).disabled?(document.getElementById("input-"+a).disabled=!1,document.getElementById("label-"+a).style.color="#107dac"):(document.getElementById("input-"+a).disabled=!0,document.getElementById("input-"+a).value="",document.getElementById("label-"+a).style.color="#7e7e7e")}
var importFile={read:function(a){if(void 0!==a[0])switch(a[0].name.split(".").pop()){case "csv":case "tsv":case "txt":importFile._csv(a[0]);break;case "xls":importFile._xls(a[0]);break;case "xlsx":importFile._xlsx(a[0])}},load:function(a){for(var b=0;b<jsonInput.length;b++)if(jsonInput[b].description===a){resetMarkers();document.getElementById("description").value=a;for(var d in jsonInput[b])if(jsonInput[b].hasOwnProperty(d)){var c=importFile._format(d);if(def.includes(c)){var e=document.getElementById("input-"+
        c);e.value=jsonInput[b][d].split(" ").join("");validateElement(e)}opt.includes(c)&&(document.getElementById("check-"+opt[b]).checked=!0,document.getElementById("label-"+b).style.color="#107dac",e=document.getElementById("input-"+b),e.disabled=!1,e.value=jsonInput[b][d].split(" ").join(""),validateElement(e))}document.getElementById("sample-label").innerHTML="Sample <b style='color:#ac3dad'>"+a+"</b> loaded";$("#sample-label").show("slide",400);dialogImport.dialog("close");break}},reload:function(a){for(var b=
            0;b<a.length;b++)a[b]=$.extend(a[b],jsonParameters()),a[b].outputFormat=$("#import-extension").val();return a},_callback:function(a){if(0===a.length)document.getElementById("samples").innerHTML="<p style='color:red;'><b>Error:</b><br>The input file is empty.</p>",jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled");else if(a[0].Marker?jsonInput=importFile._genemapper(a):(jsonInput=a,importFile._rename(jsonInput)),a=importFile._validate(jsonInput),0<a)if(1===jsonInput.length)importFile.load(jsonInput[0].description);
        else{document.getElementById("import-help").innerHTML="<b>"+jsonInput.length+" samples detected:</b>";a="<i>Click on a sample to load its values in the form or use<br>the <b>Batch Query</b> option to search them all</i><br><br>";for(var b=0;b<jsonInput.length;b++)a+="<a class='sample' onclick='importFile.load(this.innerText)'>"+jsonInput[b].description+"</a><br>";document.getElementById("samples").innerHTML=a;$("#batch").button().attr("disabled",!1).removeClass("ui-state-disabled")}else-2===a?(document.getElementById("import-help").innerHTML=
            "<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML='<span style=\'color:red;\'>No sample could be detected in the input file. Please check that your file contains a "Name", "Sample" or "Sample Name" column.</span>',jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled")):-1===a?(document.getElementById("import-help").innerHTML="<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML="<span style='color:red;'>Not all samples are named in the input file. Please name all your samples.</span>",
            jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled")):0===a&&(document.getElementById("import-help").innerHTML="<b style='color:red;'>Error:</b>",document.getElementById("samples").innerHTML="<span style='color:red;'>No compatible marker was detected in the input file.</span>",jsonInput={},$("#batch").button().attr("disabled",!0).addClass("ui-state-disabled"))},_genemapper:function(a){for(var b=[],d={},c=a[0]["Sample Name"],e=0;e<a.length;e++){a[e]["Sample Name"]!==
        c&&(d.description=c,b.push(d),d={},c=a[e]["Sample Name"]);for(var h=[],f=1;a[e]["Allele "+f];)""!==a[e]["Allele "+f]&&h.push(a[e]["Allele "+f]),f++;d[a[e].Marker]=h.join(",")}d.description=c;b.push(d);return b},_format:function(a){a=a.trim().toUpperCase().replace(" ","_");switch(a){case "AM":case "AMEL":case "AMELOGENIN":return"Amelogenin";case "THO1":return"TH01";case "CSF1P0":return"CSF1PO";case "VWA":return"vWA";case "PENTA_C":case "PENTA_D":case "PENTA_E":return"Penta_"+a[a.length-1];default:return a}},
        _rename:function(a){for(var b=[],d=0;d<a.length;d++)void 0!==a[d].SampleReferenceNbr?(a[d].description=importFile._renameCheck(b,a[d].SampleReferenceNbr),delete a[d].SampleReferenceNbr):void 0!==a[d].Sample?(a[d].description=importFile._renameCheck(b,a[d].Name),delete a[d].Sample):void 0!==a[d]["Sample Name"]?(a[d].description=importFile._renameCheck(b,a[d]["Sample Name"]),delete a[d]["Sample Name"]):void 0!==a[d].Name&&(a[d].description=importFile._renameCheck(b,a[d].Name),delete a[d].Name)},_renameCheck:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                b){if(a.includes(b)){for(var d=1;a.includes(b+"("+d+")");)d++;a.push(b+"("+d+")");return b+"("+d+")"}a.push(b);return b},_validate:function(a){if(a.some(function(a){return!a.hasOwnProperty("description")}))return-2;if(a.some(function(a){return 0===a.description.length}))return-1;for(var b=0,d=0;d<a.length;d++)for(var c in a[d])a[d].hasOwnProperty(c)&&(def.includes(c)||opt.includes(c))&&b++;return b},_csv:function(a){Papa.parse(a,{header:!0,skipEmptyLines:!0,complete:function(a){importFile._callback(a.data)}})},
        _xls:function(a){var b=new FileReader;b.onload=function(a){a=XLS.read(a.target.result,{type:"binary"});a=XLS.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{raw:!1,defval:""});importFile._callback(a)};b.readAsBinaryString(a)},_xlsx:function(a){var b=new FileReader;b.onload=function(a){a=XLSX.read(a.target.result,{type:"binary"});a=XLSX.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{raw:!1,defval:""});importFile._callback(a)};b.readAsBinaryString(a)},openDialog:function(){dialogImport.dialog("open")}},
    exportTable={toXlsx:function(a){$.ajax({type:"POST",url:"/cellosaurus-str-search/api/conversion",data:JSON.stringify(jsonResponse),contentType:"application/json",dataType:"text",mimeType:"text/plain; charset=x-user-defined",success:function(b,d,c){d=a+".xlsx";for(var e="",h=0;h<b.length;h++)e+=String.fromCharCode(b.charCodeAt(h)&255);b=new Uint8Array(e.length);for(h=0;h<e.length;h++)b[h]=e.charCodeAt(h);c=c.getResponseHeader("Content-Type");c=new Blob([b],{type:c});var f=window.URL||window.webkitURL,
                g=f.createObjectURL(c);d?(c=document.createElement("a"),"undefined"===typeof c.download?window.location=g:(c.href=g,c.download=d,document.body.appendChild(c),c.click())):window.location=g;setTimeout(function(){f.revokeObjectURL(g)},100)},error:function(a,d,c){console.log(a);console.log(d);console.log(c);alert("Error: The server is not responding\nPlease contact an administrator")}})},toCsv:function(a){var b=this._tableToCSV(document.getElementById("table-results"));b=new Blob([b],{type:"text/csv"});
            navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(b,a+".csv"):this._downloadAnchor(URL.createObjectURL(b),a+".csv")},toJson:function(a){var b=new Blob([JSON.stringify(jsonResponse,void 0,2)],{type:"text/plain"});navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(b,a+".json"):this._downloadAnchor(URL.createObjectURL(b),a+".json")},_downloadAnchor:function(a,b){var d=document.createElement("a");d.style="display:none !important";d.id="downloadanchor";document.body.appendChild(d);"download"in d&&
        (d.download=b);d.href=a;d.click();d.remove()},_tableToCSV:function(a){var b=[],d=[];var c=",\"#Description: '"+jsonResponse.description;c=c+"';Data set: 'Cellosaurus release "+jsonResponse.cellosaurusRelease;c=c+"';Run on: '"+jsonResponse.runOn;c=c+"';Tool version: '"+jsonResponse.toolVersion;c=c+"';Algorithm: '"+jsonResponse.parameters.algorithm;c=c+"';Scoring mode: '"+jsonResponse.parameters.scoringMode;c=c+"';Score filter: '"+jsonResponse.parameters.scoreFilter;c=c+"';Max results: '"+jsonResponse.parameters.maxResults;
            c=c+"';Include Amelogenin: '"+jsonResponse.parameters.includeAmelogenin;c+="'\"";for(var e=0;e<a.rows.length;e++){for(var h=0;h<a.rows[0].cells.length;h++){var f='"';f+=a.rows[e].cells[h].textContent;0===h&&a.rows[e].cells[h].innerHTML.startsWith('<a title="Problematic')&&(f+=" (Problematic cell line)");f+='"';d.push(f)}0===e?b.push(d.join(",")+c):b.push(d.join(","));d=[]}return b.join("\r\n")},openDialog:function(){dialogExport.dialog("open")}};
$(function(){dialogImport=$("#dialog-import").dialog({autoOpen:!1,height:575,width:500,modal:!1,resizable:!1,closeText:null,hide:{effect:"fold",duration:300},show:{effect:"fold",duration:300},buttons:[{text:"Batch Query",disabled:!0,id:"batch",click:function(){html.addClass("waiting");$("#import-progressbar").addClass("animate");$.ajax({type:"POST",url:"/cellosaurus-str-search/api/batch",data:JSON.stringify(importFile.reload(jsonInput)),contentType:"application/json",dataType:"text",mimeType:"text/plain; charset=x-user-defined",
            success:function(a,b,d){b="csv"===$("#import-extension").val()?"zip":$("#import-extension").val();b=$("#import-name").val()+"."+b;for(var c="",e=0;e<a.length;e++)c+=String.fromCharCode(a.charCodeAt(e)&255);a=new Uint8Array(c.length);for(e=0;e<c.length;e++)a[e]=c.charCodeAt(e);d=d.getResponseHeader("Content-Type");d=new Blob([a],{type:d});var h=window.URL||window.webkitURL,f=h.createObjectURL(d);b?(d=document.createElement("a"),"undefined"===typeof d.download?window.location=f:(d.href=f,d.download=
                b,document.body.appendChild(d),d.click())):window.location=f;setTimeout(function(){h.revokeObjectURL(f)},100)},error:function(a,b,d){console.log(a);console.log(b);console.log(d);alert("Error: The server is not responding\nPlease contact an administrator")},complete:function(){dialogImport.dialog("close");html.removeClass("waiting");$("#import-progressbar").removeClass("animate")}})}},{text:"Close",click:function(){dialogImport.dialog("close")}}]});dialogImport.find("form").on("submit",function(a){a.preventDefault()});
    dialogExport=$("#dialog-export").dialog({autoOpen:!1,height:350,width:450,modal:!0,resizable:!1,closeText:null,hide:{effect:"fold",duration:300},show:{effect:"fold",duration:300},buttons:{Save:function(){html.addClass("waiting");$("#export-progressbar").addClass("animate");jsonResponse.description=$("#description").val();switch(document.getElementById("export-extension").value){case "xlsx":exportTable.toXlsx($("#export-name").val());break;case "csv":exportTable.toCsv($("#export-name").val());break;
                case "json":exportTable.toJson($("#export-name").val());break;case "pdf":exportTable.toPdf($("#export-name").val())}dialogExport.dialog("close");html.removeClass("waiting");$("#export-progressbar").removeClass("animate")},Close:function(){dialogExport.dialog("close")}},open:function(){$("#content").addClass("blur")},close:function(){$("#content").removeClass("blur")}});dialogExport.find("form").on("submit",function(a){a.preventDefault()});$(document).tooltip({content:function(){return $(this).prop("title")},
        position:{my:"left center",at:"right+15 center"},show:null,close:function(a,b){b.tooltip.hover(function(){$(this).stop(!0).fadeTo(400,1)},function(){$(this).fadeOut("400",function(){$(this).remove()})})}})});